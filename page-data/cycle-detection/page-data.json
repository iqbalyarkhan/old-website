{"componentChunkName":"component---src-templates-post-js","path":"/cycle-detection","result":{"data":{"markdownRemark":{"html":"<h3 id=\"table-of-contents\" style=\"position:relative;\"><a href=\"#table-of-contents\" aria-label=\"table of contents permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Table of Contents</h3>\n<ol>\n<li>\n<p><a href=\"#motivation\">Motivation</a></p>\n</li>\n<li>\n<p><a href=\"#logic\">Logic</a></p>\n</li>\n<li>\n<p><a href=\"#code\">Code</a></p>\n</li>\n<li>\n<p><a href=\"#digraph\">Digraph</a></p>\n</li>\n</ol>\n<h3 id=\"motivation\" style=\"position:relative;\"><a href=\"#motivation\" aria-label=\"motivation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Motivation</h3>\n<p>Let's say we have a graph (can be directed or undirected) and want to check and see whether the graph has any cycles. A cycle is defined where the vertices are connected in a closed chain. Here is a graph that has a cycle with vertices <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">4</span></span></span></span></span>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">5</span></span></span></span></span> and <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">6</span></span></span></span></span> forming a closed chain:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 364px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.31791907514452%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjElEQVQ4y5VTS0/CQBDmN2tMvHn3P2jCRQ+GRAKJxujB2IMHIQYMSAIBDEEelrbbB9vH7Gf6WOgWNDpJu9PpzHyz38yUAEAIARIiOeMH2UmClO+8r9SlXUqpaPhN8p5FcJmnFL8iIkwNhjAiEBFABJ05uHl7xdxiAAkEQZgEzywbwy99P6AQacL32QKHlTJe+kP4tgfOXLSHExxULtHojxDYa5gGQ2BznGkaTmpXsAwPoe9DEMHlAXgMKCtkHsddqwPDcRXE2cJCFJFiGy11NAdjRGEEz3Fhrhyc3lZRfn7KOExrReTyHaJdy0HgB1u7JNJPQbjH4ZgOHro9ND4mKofmylK6l9hjkKxC+W8wn6PebEDXGTzmppznOcxwE37yyUgAj50exlkDwizwvtvB8fUFlmy98Y8LonyX406eaxomhrVBM70wCay3W5C3SIAjgukFCj07YzNY6jiq1tD9XCjXm5o2HO7vHeJUVylSBls2U4hdp6IuCpujbEoxyVbHZh1/WrN9UvoL6n/kGxFa8wBN+PBRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Undirected-Graph-1\"\n        title=\"Undirected-Graph-1\"\n        src=\"/static/b0bb329f3cd5c5f1f304b524ffc5ebfa/e45a9/example.png\"\n        srcset=\"/static/b0bb329f3cd5c5f1f304b524ffc5ebfa/991de/example.png 173w,\n/static/b0bb329f3cd5c5f1f304b524ffc5ebfa/e4d6b/example.png 345w,\n/static/b0bb329f3cd5c5f1f304b524ffc5ebfa/e45a9/example.png 364w\"\n        sizes=\"(max-width: 364px) 100vw, 364px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span> <a href=\"https://graphonline.ru/en/\">Image Credit - Cycle Graph 1</a></p>\n<p>Let's write an algorithm that answers the simple question whether an <strong>undirected</strong> graph contains a  cycle or not.</p>\n<h3 id=\"logic\" style=\"position:relative;\"><a href=\"#logic\" aria-label=\"logic permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Logic</h3>\n<p>In order to check whether a cycle exists, we'll use a modified version of <a href=\"/undirected-graphs-depth-first-search\">recursive depth first search</a>algorithm. Before we dive into the modified version let's understand logically how we can tackle this problem. Similar to DFS, we'll maintain a visited array and start with vertex 0. Here's the crux of our algorithm:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-cppcss\"><code class=\"language-cppcss\">If we find a vertex<span class=\"token punctuation\">,</span> called neighbor in a vertex's adjacency list and find that \nthe neighbor has already been visited and that neighbor is not the parent vertex<span class=\"token punctuation\">,</span> we have a cycle.</code></pre></div>\n<p>In the statement above, the <code class=\"language-cpptext\">parent</code> is the vertex that made the <code class=\"language-cpptext\">DFS</code> call. For example, if we have this adjacency list for the graph above:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-cppcss\"><code class=\"language-cppcss\">0 -> 1 -> 2\n1 -> 0 \n2 -> 0 -> 3 -> 4\n3 -> 2\n4 -> 2 -> 5 -> 6\n5 -> 4 -> 6\n6 -> 4 -> 5 </code></pre></div>\n<p>and we call DFS starting at vertex <code class=\"language-cpptext\">0</code>, then 0 would find that <code class=\"language-cpptext\">1</code> is unvisited and another recursive call would be made. This new DFS call would have the vertex as <code class=\"language-cpptext\">1</code> and parent as <code class=\"language-cpptext\">0</code> since <code class=\"language-cpptext\">0</code> initiated this new recursive call.</p>\n<p>To keep track of the parent we'd have to modify the signature of our <code class=\"language-cpptext\">DFS</code> function so that we can pass parent to each recursive call.</p>\n<p>Why does this work? It works because if there is a cycle, there has to be a back edge between two edges. In our graph above, the back edge is the edge connecting vertices 4 and 5. Let's have a look at the graph again to better understand why this works.</p>\n<p>Assume we've visited nodes 0 - 4 and the visited nodes are marked in red. Now, we're considering 4's adjacency list and about to make DFS calls based off it:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 364px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.31791907514452%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABk0lEQVQ4y5VTW0vDUAzuzxYE0df9B8X5MFAQFER9UFC2B33YcIpOK9NNJu5iu/b0dnrJ+aSXU9utigbapCHNl3xJFAAQQoCESHT8INNEVPouxkpb+qUoi47fpBi5CC7zKPErIsK7yRBGlFQFImjMxvF9FxOTASQQBGGix6aFvqZXAwqRJnwcT7Ha2ERbfQG3PHDLwd3rCGv1OjrPAwS2B1Nn8G2O7csmansNGIaL0PchiODwADwGlBUy10PrugvDckqIs485KKKSbzjVcKsOEIURXMuBoduonR6iftXMOExrRej6S0TbzE5blX6ZNUgt7nLYho3z3hPab6MChxHB0E0QfU8v8Ts8Jjix5WT7kwmOOm1oGoPLnJTzIocSN7B4KVmc+6KnYviZDiDMfjzrPWDloIEZ8/L4eKhUnHI8ya1mC6O5maPNvQjruzs4uelCbkICHHfjBiV6ltamP9Ow0diHOpqk1WWtj3UGh/uVS5zaZYpKiy2iTFcELdpi4XJKl1J0JslyG/k5/nRmVaL8BfU/8gXXxvLrPL42SAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Undirected-Graph-1\"\n        title=\"Undirected-Graph-1\"\n        src=\"/static/b0d633bc05166f3cd49b7fefcc7775a9/e45a9/example_visited_1.png\"\n        srcset=\"/static/b0d633bc05166f3cd49b7fefcc7775a9/991de/example_visited_1.png 173w,\n/static/b0d633bc05166f3cd49b7fefcc7775a9/e4d6b/example_visited_1.png 345w,\n/static/b0d633bc05166f3cd49b7fefcc7775a9/e45a9/example_visited_1.png 364w\"\n        sizes=\"(max-width: 364px) 100vw, 364px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span> <a href=\"https://graphonline.ru/en/\">Image Credit - Cycle Graph 2</a></p>\n<p>At this point, 4 was called from vertex 2 so 2 is the parent here. This is 4's adjacency list:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-cppcss\"><code class=\"language-cppcss\">4 -> 2 -> 5 -> 6</code></pre></div>\n<p>We pick 2 and see it has already been visited and check to see if 2 is 4's parent which it is so we move on to the next element. Next we find 5 and see it has not been visited so we mark it as visited and call DFS again but this time with vertex as 5 and parent as 4:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 364px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.31791907514452%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABlElEQVQ4y5VTW0vDUAzezxYE0VfxLyhOYaAg7EHciw/qhuCDw010MpluMHEX27Wnt9NLzic97el2tikaaJOGNF/yJSkBgBACJITU6YNcE5H2vRirbOVXUlp2/CaLkcvgKk8pfSVE+LAZ4oRkVSCCwVxcPLUwthlAAlEUSz2yHfQMcz2gEFnCl9EEm5V93HffwJ0A3PHw+D7EVrmM5msfkRvANhlCl+Pwuo7d0wosy0cchhBE8MIIPAVUFTI/QOOuBcvxNMTp5wyUkOYbTAy0u30kcYLA8WCZLvZqVRzf1nMOs1oR++EK0S5zs1aVX2WNMov7HK7t4qbdQbs3WOAwIVimDaL59KTf4ynB0laT7Y3HOG/ewzAYfObJljUOFW7kcC1Zmvuq08XgKxtAnP942XnGRrWCKQvma0RUAMoK00ke1BsYzuwCbRYk2D45Qu2hBbUJEjjtxo80elbWpjc1sFM5Q3c4zqrLWx+ZDB4P1y5xZusUaYstklyvCVq2xdLlaJey6JTJChvFOf50Zuuk9BfU/8g31/ny617nLEIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Undirected-Graph-1\"\n        title=\"Undirected-Graph-1\"\n        src=\"/static/fbce0b0f131e1089029a7f3c70a4edc9/e45a9/example_visited_2.png\"\n        srcset=\"/static/fbce0b0f131e1089029a7f3c70a4edc9/991de/example_visited_2.png 173w,\n/static/fbce0b0f131e1089029a7f3c70a4edc9/e4d6b/example_visited_2.png 345w,\n/static/fbce0b0f131e1089029a7f3c70a4edc9/e45a9/example_visited_2.png 364w\"\n        sizes=\"(max-width: 364px) 100vw, 364px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span> <a href=\"https://graphonline.ru/en/\">Image Credit - Cycle Graph 3</a></p>\n<p>Again we look in 5's adjacency list:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-cppcss\"><code class=\"language-cppcss\">5 -> 4 -> 6</code></pre></div>\n<p>and find 4. 4 is already visited and is the parent so we move on to the next vertex in the list. Next we find 6, 6 is not visited so we call DFS with 6 as the vertex and 5 as the parent:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 364px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.31791907514452%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkklEQVQ4y5VTWUvDQBDu/xY8XsW/oFiFQgVBEPTRoyL44NFKqVSrLVTsYdJks0k2x+wn2WTTpofoQDKTye58M9/MlABASgmSUunkQaaJqPA9e1bb2q+lNO/4TWZPzoPrOKXkFRPh02aIYlJZgQgG4zhr1jG0GUASYRgpPbAddAxzOaCUacCXwQhrlV3ct98hHB/CcfH80cd6uYyH1y5C7sM2GQIusH9Vw/ZRBZblIQoCSCK4QQiRAOoMmefj5q4Oy3ELiOOvCSimgq83MtBodxFHMXzHhWVy7Jyf4PC2lnGY5orICxaI5oynpWq/JjJM/wtPgNsc140WGp3eDIcxwTJtEE27p/yuSAhWtu7s23CE08d7GN8MHnNVyQUOM1yEjigES2JfttrofacNiLKLF80mNqqHGDn+dIyIckCVYdLJvdoN+hM7R5v4MTarBzh/qkNPggocERgv0rMwNp2xga3KMdr9YZpdVvrAZHBFsHSIV9n5YMs405C/XpjPaGFTZp0qWG4jX8dVa7ZMSn9B/Y/8AM5K8ubMOcqHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Undirected-Graph-1\"\n        title=\"Undirected-Graph-1\"\n        src=\"/static/b8b9568772110e525ade4ef09380cc15/e45a9/example_visited_3.png\"\n        srcset=\"/static/b8b9568772110e525ade4ef09380cc15/991de/example_visited_3.png 173w,\n/static/b8b9568772110e525ade4ef09380cc15/e4d6b/example_visited_3.png 345w,\n/static/b8b9568772110e525ade4ef09380cc15/e45a9/example_visited_3.png 364w\"\n        sizes=\"(max-width: 364px) 100vw, 364px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span> <a href=\"https://graphonline.ru/en/\">Image Credit - Cycle Graph 4</a></p>\n<p>For vertex 6, we find this adjacency list:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-cppcss\"><code class=\"language-cppcss\">6 -> 4 -> 5 </code></pre></div>\n<p>and we choose the first vertex in the list which is 4. We find that 4 is already visited BUT this time, we also find that 4, even though is visited, it is NOT the parent vertex. We've found a link to the grandparent (in terms of recursive calls). We have a cycle. This check for parent is necessary for undirected graphs because the current vertex's parent is already visited because we got to the current vertex through its parent. We're only interested in the vertex if the visited vertex is NOT the parent which was true for the last case above.</p>\n<h3 id=\"code\" style=\"position:relative;\"><a href=\"#code\" aria-label=\"code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Code</h3>\n<p>Let's have a look at the modified <code class=\"language-cpptext\">DFS</code> function that I've called <code class=\"language-cpptext\">CycleDFS</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cppcpp\"><code class=\"language-cppcpp\"><span class=\"token keyword\">bool</span> <span class=\"token class-name\">AdjList</span><span class=\"token operator\">::</span><span class=\"token function\">CyclePresent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> vectorSize<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>visited<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            <span class=\"token function\">CycleDFS</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hasCycle<span class=\"token punctuation\">)</span>\n        cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"There is a cycle!\"</span> <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> hasCycle<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">//Visited is an array that keeps track of visited vertices</span>\n<span class=\"token comment\">//adjList is a vector of vectors to represent the adjacency list for each vertex</span>\n<span class=\"token comment\">//hasCycle is an instance variable to keep track of wether graph as a cycle</span>\n<span class=\"token keyword\">void</span> <span class=\"token class-name\">AdjList</span><span class=\"token operator\">::</span><span class=\"token function\">CycleDFS</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> v<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> parent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"v is: \"</span> <span class=\"token operator\">&lt;&lt;</span> v <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\" and parent is: \"</span> <span class=\"token operator\">&lt;&lt;</span> parent <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n    visited<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> adjList<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">int</span> neighbor <span class=\"token operator\">=</span> adjList<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>visited<span class=\"token punctuation\">[</span>neighbor<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token function\">CycleDFS</span><span class=\"token punctuation\">(</span>neighbor<span class=\"token punctuation\">,</span> v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>neighbor <span class=\"token operator\">!=</span> parent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n                hasCycle <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We've got a helper function, <code class=\"language-cpptext\">CyclePresent</code>, that calls <code class=\"language-cpptext\">CycleDFS()</code> initially with vertex 0 and parent as -1 since vertex 0 has no parent. We continue calling the function and marking the <code class=\"language-cpptext\">visited</code> array. At one point, we reach the case where we process vertex 6 and it is called by vertex 5 (5 is the parent). At this point, we find 4 in 6's adjacency list which has already been visited (we reached 5 via 4 so 4 has already been visited). We check to see if neighbor, which is 4, is not equal to the parent, which is 5. The neighbor is indeed not equal to the parent and we have a cycle.</p>\n<h3 id=\"digraph\" style=\"position:relative;\"><a href=\"#digraph\" aria-label=\"digraph permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Digraph</h3>\n<p>Now, let's answer the same question for a digraph. You might ask: \"Why doesn't the algorithm above work for a digraph?\". Let's take an example:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 269px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.65895953757226%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAABsklEQVQ4y61Uy07CQBTtb/oLsnXhJxijJhrdGBdKjMSFunDjCwIJRKPiI1GgqNjySLG0QAmVRztzzFQotZ2KC28yae9Me3rOubdXgC8ope51vH7Lve+wEPxg40NCKQglXMDvPcoFFfzM/PdODk5QcJ8X/OzI6LCgqNjKXELSWk5u2zYsy4bdH+Dto4nVxAkSBTGgTBhvEJ9HG6krzEQ3sJPO4lM3oNV1Z9WLZRxePSGyv4aVeNxhSuEB5MmrimXc5UrYyz5DaXcCavuWheNsHrLWnkj2MiSEQtK6MM0emnUdRtMAr1heBT3d4PrtAJ7mXjB/uI5o5tY1m1lgExLaNkw+I8L1MCGWMHewjdjlvfulMEAmjQGpNRWEkJAqU0Ax+uiZfeiKBrNjhkr+LjlBJS+7vv0A9HvAmMm5dxTeKki9SjAHw0C/PVYVbCbTbsECDL1tM2a8cpFCJLaEo5sn9Jod6GoLaq0B+VnC8nkSs7FFHD2II8JkemMniyUsnJ2hqDRYG2A4tJzF5OYVFbvXj2h0ur//Kbw2mBbctgmdNJhU1lsY4rPoT9Nm2rj60/j6j/gCdvcny1Bx2YcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Undirected-Graph-1\"\n        title=\"Undirected-Graph-1\"\n        src=\"/static/bc09fc673ead44be43b4ff3aafeccfde/98fe2/digraph1.png\"\n        srcset=\"/static/bc09fc673ead44be43b4ff3aafeccfde/991de/digraph1.png 173w,\n/static/bc09fc673ead44be43b4ff3aafeccfde/98fe2/digraph1.png 269w\"\n        sizes=\"(max-width: 269px) 100vw, 269px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span> <a href=\"https://graphonline.ru/en/\">Image Credit - Di Graph 1</a></p>\n<p>For the graph above, we'll have this adjacency list:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-cppcss\"><code class=\"language-cppcss\">0 -> 1 -> 3\n1 -> 2\n2 -> 4\n3 -> 4\n4 </code></pre></div>\n<p>Say we're starting at vertex 0, we'll go through the undirected graph algorithm and find that we'll end up at vertex 4 via 2 paths (as show from the digraph). When we reach <code class=\"language-cpptext\">4</code> from the 0->3->4 path, the undirected graph algo will return true saying that there does exist a cycle while in reality there isn't! We need another approach:</p>\n<p>We can keep track of our current path using a boolean array and if at any point we reach a vertex in the graph that is on the current path or call stack, we know there's a <strong>back edge</strong>. As we return our recursive calls, we'll update the <code class=\"language-cpptext\">onStack</code>. Here's this logic converted to code:</p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre style=\"counter-reset: linenumber 0\" class=\"language-cppcpp line-numbers\"><code class=\"language-cppcpp\"><span class=\"token keyword\">void</span> <span class=\"token function\">DFS</span><span class=\"token punctuation\">(</span>vector<span class=\"token operator\">&lt;</span>vector<span class=\"token operator\">&lt;</span><span class=\"token keyword\">int</span><span class=\"token operator\">>></span><span class=\"token operator\">&amp;</span> graph<span class=\"token punctuation\">,</span> vector<span class=\"token operator\">&lt;</span><span class=\"token keyword\">bool</span><span class=\"token operator\">></span><span class=\"token operator\">&amp;</span> visited<span class=\"token punctuation\">,</span> vector<span class=\"token operator\">&lt;</span><span class=\"token keyword\">bool</span><span class=\"token operator\">></span><span class=\"token operator\">&amp;</span> onStack<span class=\"token punctuation\">,</span> <span class=\"token keyword\">bool</span><span class=\"token operator\">&amp;</span> hasCycle<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hasCycle<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    visited<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>onStack<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        hasCycle <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    \n    onStack<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> graph<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">int</span> curr <span class=\"token operator\">=</span> graph<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>onStack<span class=\"token punctuation\">[</span>curr<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token function\">DFS</span><span class=\"token punctuation\">(</span>graph<span class=\"token punctuation\">,</span> visited<span class=\"token punctuation\">,</span> onStack<span class=\"token punctuation\">,</span> hasCycle<span class=\"token punctuation\">,</span> curr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            hasCycle <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    \n    onStack<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Notice how we're updating the <code class=\"language-cpptext\">onStack</code> variable on line 10 for the current vertex and once we're done processing its neighbors, we change the value in <code class=\"language-cpptext\">onStack</code> back to false. This way, we'll always have correct path present in this array.</p>","timeToRead":6,"excerpt":"Table of Contents Motivation Logic Code Digraph Motivation Let's say we have a graph (can be directed or undirected) and want to check andâ€¦","frontmatter":{"title":"Cycle Detection","date":"2020-03-10T00:00:00.000Z","categories":["Graphs"],"extract":"Analysis of an algorithm to detect whether an undirected graph has a cycle","thumbnail":"/post-images/cycle.png","tags":["Graphs","General Algorithms"]},"fields":{"slug":"/cycle-detection","date":"March 10, 2020"}}},"pageContext":{"slug":"/cycle-detection","nexttitle":"Bipartite Graphs","nextslug":"/bipartite-graphs","prevtitle":"Topological Sort","prevslug":"/topological-sort"}},"staticQueryHashes":["3969716136"]}