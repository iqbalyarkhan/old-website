---
date: 2021-12-13
draft: false
thumbnail: /post-images/aws-s3.png
title: AWS - S3
extract: Notes for S3
categories:
    - AWS
tags:
    - blog
    - AWS
--- 


### Table of Contents

- [What is S3?](#what-is-s3)
- [S3 Basics](#s3-basics)
- [S3 Objects](#s3-objects)
  - [Object Key](#object-key)
  - [Object Value](#object-value)
  - [Object Metadata](#object-metadata)
  - [Object Version ID](#object-version-id)
- [S3 Buckets](#s3-buckets)
- [S3 Versioning](#s3-versioning)
- [S3 Tiers](#s3-tiers)
- [Lifecycle Management](#lifecycle-management)
- [Securing your data](#securing-your-data)
- [Consistency Model](#consistency-model)



## What is S3?
Simple Storage Service, or S3, provides object storage in the cloud. It is a durable and highly scalable service. S3 is object based storage: meaning it manages data as objects rather than file system. S3 is a key value store where key is the name you give your object and value is the object itself. You can upload any file type to S3 (image, text, videos, HTML files etc). You however, cannot run OSs or DBs on S3! You store your static files in S3. 

## S3 Basics
You can store unlimited number of objects in S3. Objects can be from 0B to 5TB in size. Files are stored in a bucket. 

![S3-Basics](./images/aws/s3-basics.png)[Image Credit - Acloud guru](https://acloudguru.com/)

## S3 Objects
An S3 [object](https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingObjects.html) is comprised of a key, a value, a versionId and metadata. Let's take a look at some of these in more detail:

### Object Key
The name that you assign to an object. You use the object key to retrieve the object. The object key (or key name) uniquely identifies the object in an Amazon S3 bucket. 

### Object Value

Value is the actual content that you are storing. An object value can be any sequence of bytes. Objects can range in size from zero to 5 TB. If your object size is >= 5MB, it is suggested to use multi-part upload. The multipart upload API is designed to improve the upload experience for larger objects. You can upload an object in parts. These object parts can be uploaded independently, in any order, and in parallel. You can use a multipart upload for objects from 5 MB to 5 TB in size. 

### Object Metadata
Along with the object data (bytes that make your object), there also exists object metadata. The metadata is a set of name-value pairs that describe the object. These pairs include some default metadata, such as the date last modified, and standard HTTP metadata, such as Content-Type. You can also specify custom metadata at the time that the object is stored. 

There are two kinds of metadata in Amazon S3: system-defined metadata and user-defined metadata. System metadata information include the following:
- Date
- Content-Length	
- Content-Type	
- Last-Modified	
- x-amz-server-side-encryption
- x-amz-version-id	
- x-amz-delete-marker	
- x-amz-storage-class	
- x-amz-website-redirect-location	

and more! 

User-defined metadata can be defined when uploading an object. You provide this optional information as a name-value (key-value) pair when you send a PUT or POST request to create the object. When you upload objects using the REST API, the optional user-defined metadata names must begin with "x-amz-meta-" to distinguish them from other HTTP headers. When you retrieve the object using the REST API, this prefix is returned. 

More info on metadata [here](https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingMetadata.html)

### Object Version ID
Version ID allows you to store multiple versions of the same object. See versioning section below. 

## S3 Buckets
A bucket is a container for objects stored in Amazon S3. You can store any number of objects in a bucket and can have up to 100 buckets in your account. To request an increase, visit the Service Quotas Console. Here're a few properties related to our S3 buckets:

- **Universal Namespace**

An Amazon S3 bucket name is globally unique, and the namespace is shared by all AWS accounts. This means that after a bucket is created, the name of that bucket cannot be used by another AWS account in any AWS Region until the bucket is deleted. You should not depend on specific bucket naming conventions for availability or security verification purposes. Amazon S3 creates buckets in a Region that you specify. To optimize latency, minimize costs, or address regulatory requirements, choose any AWS Region that is geographically close to you.  

- **Bucket URLs**

Each bucket that you create will have a URL associated with it. The URL will follow this convention:

`https://<bucket-name>.s3.<Region>.amazonaws.com/<key-name>`

For example, if the object named photos/puppy.jpg is stored in the DOC-EXAMPLE-BUCKET bucket in the US West (Oregon) Region, then it is addressable using the URL `https://DOC-EXAMPLE-BUCKET.s3.us-west-2.amazonaws.com/photos/puppy.jpg`. When you create a bucket, you enter a bucket name and choose the AWS Region where the bucket will reside. After you create a bucket, you cannot change the name of the bucket or its Region. Bucket names must follow the bucket naming rules. 

## S3 Versioning
You can use S3 Versioning to keep multiple variants of an object in the same bucket. With S3 Versioning, you can preserve, retrieve, and restore every version of every object stored in your buckets. You can easily recover from both unintended user actions and application failures. **Versioning helps you recover accidental overwrites and deletes.** It is recommend to use versioning as a best practice to recover objects from being deleted or overwritten by mistake.

Buckets can be in one of three states: Unversioned (the default), versioning-enabled or versioning-suspended. You enable and suspend versioning at the bucket level. After you version-enable a bucket, it can never return to an unversioned state. But you can suspend versioning on that bucket.  When you enable versioning in a bucket, all new objects are versioned and given a unique version ID. Objects that already existed in the bucket at the time versioning was enabled will thereafter always be versioned and given a unique version ID when they are modified by future requests. 

## S3 Tiers

- **Standard S3**

  - Data is stored redundantly across multiple devices in multiple facilities ( >= 3AZs).
  - 99.99% availability
  - 99.999999999% durability
  - Designed for frequent access
  - Suitable for websites, content distribution, mobile and gaming apps, big data analytics etc

- **Tiered Storage**
  

## Lifecycle Management
There are methods in place to move your data from different S3 tiers.

## Securing your data

- **Server side encryption**:
You can set default encryption on a bucket to encrypt all new objects when they are stored in the bucket. 

- **ACLs**:
Define which AWS accounts or groups are granted access and the type of access on your buckets. You can attach S3 ACLs to individul objects within a bucket. Much more fine grained access policies! 

- **Bucket Policies**:
S3 bucket policies that specify what action are allowed or denied (example user A can PUT but not DELETE). Bucket policies are obviously bucket wide. These are IAM policies for S3 buckets. This is more general as compared to ACLs. 

## Consistency Model

S3 has **strong read after write consistency** meaning that after a successful write of a new object (PUT, UPDATE or DELETE), any subsequent read requests immediately receive the latest version of the object. 

S3 is strongly consistent for LIST operations



