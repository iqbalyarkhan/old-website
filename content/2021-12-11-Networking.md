---
date: 2021-12-11
draft: false
thumbnail: /post-images/networking.png
title: Networking Basics
extract: Notes for Networking
categories:
    - AWS
tags:
    - blog
    - AWS
--- 


### Table of Contents

- [Intro](#intro)
- [Layer 1 - Physical](#layer-1---physical)
- [Layer 2 - Data Link Layer](#layer-2---data-link-layer)
- [Layer 3 - Network](#layer-3---network)
  - [Packets](#packets)



## Intro


Before we can fully understand what VPC is and how it operates, it is important to understand fundamentals of networking. As an intro, we'll be going through some of the important layers present in the OSI network model:

![OSI-Networking](./images/aws/osi-model.png)[Image Credit](https://www.geeksforgeeks.org/layers-of-osi-model/)

We'll start at the bottom layer (physical) and make our way up to the top layer (application). All of these layers combined together create your networking stack. 

Layers 1-3 can be thought of as the media layer which deals with sending data from point A to point B.

Layers 5-7 can be thought of as the host layers which deals with chopping of data and transporting it. 

## Layer 1 - Physical

Let's start with layer 1. If you want to connect 2 machines (laptops, servers etc), you can use the same wifi network or a network cable. Let's assume, we're using a network cable to connect A with B. This network cable is literally your copper cable! Therefore, the signal used to transfer information between A and B would be electrical for our example. We can also use WiFi to connect A to B (where signal would be radio frequency) or a fiber link (where signal would be light).

![Physical-Layer](./images/aws/physical-layer.png)

Layer 1 specs define how data is transmitted where data is raw bit (1s and 0s) streams between 2 devices using a shared physical medium. The specs define what voltage levels will be used, the timing of our signals, the rates etc. It is at this layer wher we determine what level of voltage would represent 1 bit and what level would represent 0 bit. Therefore a layer 1 device just understands layer 1 communication methods. While a layer 3 device would understand layers 1, 2 AND 3. 

What if we need more devices connect to each other? Say 4 devices? You can use a hub to connect 4 devices together. A hub's job is to transmit a message received on any port to every other port. However, with hub communication, you can: 

- only have 1 device transmitting at a time 
- because there're no device addresses! 
- If 2 devices transmit at the same time, the message is corrupted. 
- there's no method to control media collision or media access control
- not scalable if we can't handle collision

## Layer 2 - Data Link Layer

Layer 2 network works on top of layer 1. This means, we'll build on top of what we already had in layer 1. Layer 2 introduces the ideas of:

- **frames**: instead of focusing on voltages, frames are used. Frames help "package data". 
- **device addresses**: devices at L2 have unique hardware, MAC, addresses. 
- **carrier checks**: to prevent collisions on layer 1.

Layer 2 will provide frames and device addresses which will then be transported via layer 1 mediums. So when layer 1 is transmitting a frame it won't understand what it is transmitting but would still do its job which is to transport data from A to B.

The frame contains information such as destination MAC address, source MAC address, payload (actual data that we want delivered) and ET (ethernet type). This payload is generally generated by layer 3! Layer 2 frames are generated by the software on the source side. These frames are then transmitted to the destination via layer 1 and received by the destination at layer 1. If there's a carrier flag detected by layer 2 on layer 1, the message is not sent. The carrier flag signifies that another message is currently being transmitted via layer 1. This helps prevent collision. If both sides detect no carrier and send at the same time, we can use collision detection, or CD, to determine that. This triggers a jam signal that triggers a random back off period where all sides stop sending signals and one transmitter at random will start again. If no carrier flag is detected, the frame is then transmitted on to layer 2 on destination side and the frame is interpreted here before the payload is passed on to layer 3 on the destination side.

Remember we used hub for layer 1? If we use layer 2 devices using a hub, we'd still get lots of collisions and corruption. We can use switches for the transport layer as well where a switch is a layer 2 device. Switches use a MAC address table that keeps track of what port each MAC is on. This allows switches to direct frames to correct machines. 

## Layer 3 - Network

Layer 3 requires a functional layer 2. The job of layer 3 is to move data from source to destination: for example, from youtube server to your local device via the internet. 

Say we have 2 layer 2 local are networks that are geographically separated and isolated (one is in us-east-1 and the other is in us-west-2). Devices can communicate with each other within their LANs but not outside of their local networks. You can use a point-to-point (or P2P) link to connect these 2 LANs but that would be expensive and is not scalable!

Layer 3 is that common protocol that can be used to connect layer 2 networks that are using different protocols. This adds internet protocol or IP addresses to the LANs and routing to move data between LANs without using direct P2P links. This means that the source and destination have IP addresses and the destination can request for data from source. IP "packets" are moved from source to destination via intermediate networks (or internet!) and the information is encapsulated in different frames along the way.

### Packets

Packets are simialr to frames but the difference is that the source and destination of a packet can be global whereas frames generally have local destinations and source. Generally during their journey, the packets remain the same. Packets are placed inside frames where each frame is specific to the local network that the packet is moving through. The frames change as the LAN changes while the packet remains unchanged. 

There're 2 versions of IP packet structures: IPv4 and IPv6. Similar to frames, the IP packet contains various different fields. The important ones are:

- source and destination IP address fields. IPv6 source and destination numbers are larger as compared to IPv4 packet.
- protocol: this is the protocol provided by layer 4. Example could be ICMP (pings!), TCP or UDP. The destination layer 3 would then know which layer 4 data protocol to pass the data into.
- ttl or hop limit in IPv6: time to live determines how many hops the packet is allowed to make from network to network in case the packets hops around the world for some reason.
- data! 
